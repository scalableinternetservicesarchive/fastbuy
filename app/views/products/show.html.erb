<!--p id="notice"><%= notice %></p-->

<div id='product_title'>
  <strong>Title:</strong>
  <%= @product.title %>
</title>

<div id='product_description'>
  <strong>Description:</strong>
  <%= sanitize(@product.description) %>
</div>

<div id='product_image'>
  <%= image_tag(@product.image_url) %>
  <!--%= button_to 'Add to Cart', line_items_path(product_id: @product, quantity: 1), remote: true, class: "product_button"  %-->
 
  <!--%= link_to 'Add to Cart', line_items_path(product_id: @product, quantity: 1), remote: true, method: :post, class: "product_button"  %-->
</div>

<br/>
<br/>

<div id='product_price'>
  <strong>Price:</strong>
  <%= number_to_currency(@product.price) %>
</div>

<div id='product_rating'>
  <strong>Rating:</strong>
  <%= @product.rating %>
</div>

<div id= 'product_quantity'>
  <strong>Quantity:</strong>
  <%= @product.quantity %>
</div>

<div id= 'product_button'>
 <% if @cart.class == Cart %> <!-- Need Fixes Here i-->
   <% if current_line_item = @cart.line_items.find_by(product_id: @product.id) %>
     <!-- the product can be found in the cart, use PUT-->
     <%= form_tag line_items_path(product_id: @product.id), method: :post, remote: true, class: "product_button" do %>
       <% if @product.quantity - current_line_item.quantity == 0 %>
         <%= number_field_tag(:quantity, nil, in: 0..0) %>
         <%= submit_tag("Add to Cart", disabled: true)%>
       <% else %>
         <%= number_field_tag(:quantity, nil, in: 1..@product.quantity \
         - current_line_item.quantity) %>
         <%= submit_tag("Add to Cart") %>
       <% end %>
     <% end %>
   <% else %>
   <!-- the product cannot be found in the cart, use POST-->
     <%= form_tag line_items_path(product_id: @product), remote: true, class: "product_button" do %>
       <% if @product.quantity == 0 %>
         <%= number_field_tag(:quantity, nil, in: 0..0) %>
         <%= submit_tag("Product Unavailable", disabled: true)%>
       <% else %>
         <%= number_field_tag(:quantity, nil, in: 1..@product.quantity) %>
         <%= submit_tag("Add to Cart") %>
       <% end %>
     <% end %>
   <% end %>
 <% else %>

   <!-- TODO-->
 <% end %>
</div>
